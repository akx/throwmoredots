{"version":3,"sources":["webpack:///client.ab5b3670.js","webpack:///./index.js"],"names":["webpackJsonp","module","exports","__webpack_require__","__webpack_exports__","setInputImage","file","fr","FileReader","onload","event","url","result","img","Image","src","inputSVGSize","width","height","inputSVGDataURL","inputSVGImage","__WEBPACK_IMPORTED_MODULE_0_mithril___default","a","redraw","onerror","alert","readAsDataURL","render","image","spacing","radius","offsetX","offsetY","canvas","document","createElement","ctx","getContext","drawImage","data","getImageData","circles","y","x","ox","oy","offset","_data$data$slice","slice","_data$data$slice2","_slicedToArray","r","g","b","push","renderedToSVG","rendered","map","c","cx","cy","fill","xmlns","exportSVG","tree","frag","createDocumentFragment","xml","firstChild","outerHTML","File","header","Date","type","URL","createObjectURL","downloadLink","Object","assign","href","download","name","body","appendChild","click","setTimeout","parentNode","removeChild","revokeObjectURL","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_mithril__","n","__WEBPACK_IMPORTED_MODULE_1__style_css__","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","length","err","Array","isArray","TypeError","options","optionNumberInput","field","attrs","finalAttrs","oninput","e","target","valueAsNumber","view","accept","onchange","files","min","step","onclick","disabled","mount"],"mappings":"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","file":"client.ab5b3670.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */,\n/* 1 */\n/*!************************!*\\\n  !*** multi ./index.js ***!\n  \\************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(/*! /Users/akx/build/throwmoredots/index.js */2);\n\n\n/***/ }),\n/* 2 */\n/*!******************!*\\\n  !*** ./index.js ***!\n  \\******************/\n/*! no exports provided */\n/*! all exports used */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_mithril__ = __webpack_require__(/*! mithril */ 3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_mithril___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_mithril__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__style_css__ = __webpack_require__(/*! ./style.css */ 7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__style_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__style_css__);\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\n\n\n\nvar inputSVGDataURL = null;\nvar inputSVGSize = null;\nvar inputSVGImage = null;\nvar options = {\n  width: 800,\n  height: 600,\n  spacing: 20,\n  radius: 10,\n  offsetX: 0,\n  offsetY: 0\n};\nvar rendered = null;\n\nfunction setInputImage(file) {\n  var fr = new FileReader();\n  fr.onload = function (event) {\n    var url = fr.result;\n    var img = new Image();\n    img.src = url;\n    img.onload = function () {\n      inputSVGSize = {\n        width: img.width,\n        height: img.height\n      };\n      inputSVGDataURL = url;\n      inputSVGImage = img;\n      __WEBPACK_IMPORTED_MODULE_0_mithril___default.a.redraw();\n    };\n    img.onerror = function () {\n      alert('Invalid image.');\n    };\n  };\n  fr.readAsDataURL(file);\n}\n\nfunction render(image, width, height, spacing, radius, offsetX, offsetY) {\n  var canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  var ctx = canvas.getContext('2d');\n  ctx.drawImage(image, 0, 0, width, height);\n  var data = ctx.getImageData(0, 0, width, height);\n  var circles = [];\n  for (var y = 0; y < height; y += spacing) {\n    for (var x = 0; x < width; x += spacing) {\n      var ox = x + offsetX;\n      var oy = y + offsetY;\n      if (ox < 0 || ox >= width || oy < 0 || oy >= height) {\n        continue;\n      }\n      var offset = data.width * oy * 4 + ox * 4;\n\n      var _data$data$slice = data.data.slice(offset, offset + 4),\n          _data$data$slice2 = _slicedToArray(_data$data$slice, 4),\n          r = _data$data$slice2[0],\n          g = _data$data$slice2[1],\n          b = _data$data$slice2[2],\n          a = _data$data$slice2[3];\n\n      if (a > 192) {\n        circles.push({ x: x + radius, y: y + radius, r: r, g: g, b: b, radius: radius });\n      }\n    }\n  }\n  return { circles: circles, width: width, height: height };\n}\n\nfunction renderedToSVG(rendered) {\n  var circles = rendered.circles.map(function (c) {\n    return __WEBPACK_IMPORTED_MODULE_0_mithril___default()('circle', { cx: c.x, cy: c.y, r: c.radius, fill: 'rgb(' + c.r + ', ' + c.g + ', ' + c.b + ')' });\n  });\n  return __WEBPACK_IMPORTED_MODULE_0_mithril___default()('svg', {\n    width: rendered.width,\n    height: rendered.height,\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, circles);\n}\n\nfunction exportSVG(rendered) {\n  var tree = renderedToSVG(rendered);\n  var frag = document.createDocumentFragment();\n  __WEBPACK_IMPORTED_MODULE_0_mithril___default.a.render(frag, tree);\n  var xml = frag.firstChild.outerHTML;\n  var header = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>';\n  var file = new File([header, xml], 'dots-export-' + +new Date() + '.svg', {\n    type: 'image/svg+xml'\n  });\n  var url = URL.createObjectURL(file);\n  var downloadLink = Object.assign(document.createElement('a'), {\n    href: url,\n    download: file.name\n  });\n  document.body.appendChild(downloadLink);\n  downloadLink.click();\n  setTimeout(function () {\n    downloadLink.parentNode.removeChild(downloadLink);\n    URL.revokeObjectURL(url);\n  }, 1000);\n}\n\nvar optionNumberInput = function optionNumberInput(field, attrs) {\n  var finalAttrs = Object.assign({\n    type: 'number',\n    value: options[field],\n    oninput: function oninput(e) {\n      options[field] = e.target.valueAsNumber;\n    }\n  }, attrs);\n  return __WEBPACK_IMPORTED_MODULE_0_mithril___default()('input', finalAttrs);\n};\n\nvar view = function view() {\n  return [__WEBPACK_IMPORTED_MODULE_0_mithril___default()('div#controls', [__WEBPACK_IMPORTED_MODULE_0_mithril___default()('label', [__WEBPACK_IMPORTED_MODULE_0_mithril___default()('input[type=file]', {\n    accept: 'image/*',\n    onchange: function onchange(event) {\n      return setInputImage(event.target.files[0]);\n    }\n  })]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('label', 'Output Size', [optionNumberInput('width', { min: 0, step: 1 }), 'x', optionNumberInput('height', { min: 0, step: 1 }), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('button', {\n    onclick: function onclick() {\n      options.width = inputSVGSize.width;\n      options.height = inputSVGSize.height;\n    },\n    disabled: !inputSVGSize\n  }, 'From Original')]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('label', 'Circle Spacing', [optionNumberInput('spacing', { min: 1, step: 1 })]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('label', 'Circle Radius', [optionNumberInput('radius', { min: 1, step: 1 })]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('label', 'Offset', [optionNumberInput('offsetX', { step: 1 }), 'x', optionNumberInput('offsetY', { step: 1 })]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('button', {\n    onclick: function onclick() {\n      rendered = render(inputSVGImage, options.width, options.height, options.spacing, options.radius, options.offsetX, options.offsetY);\n    },\n    disabled: !inputSVGImage\n  }, 'Render'), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('button', {\n    onclick: function onclick() {\n      exportSVG(rendered);\n    },\n    disabled: !rendered\n  }, 'Export')]), __WEBPACK_IMPORTED_MODULE_0_mithril___default()('div#inout', [inputSVGDataURL ? __WEBPACK_IMPORTED_MODULE_0_mithril___default()('div#input', __WEBPACK_IMPORTED_MODULE_0_mithril___default()('img', { src: inputSVGDataURL })) : null, rendered ? __WEBPACK_IMPORTED_MODULE_0_mithril___default()('div#output', rendered ? renderedToSVG(rendered) : null) : null])];\n};\n\n__WEBPACK_IMPORTED_MODULE_0_mithril___default.a.mount(document.body, { view: view });\n\n/***/ }),\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */\n/*!*******************!*\\\n  !*** ./style.css ***!\n  \\*******************/\n/*! dynamic exports provided */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n],[1]);\n\n\n// WEBPACK FOOTER //\n// client.ab5b3670.js","import m from 'mithril';\nimport './style.css';\n\nlet inputSVGDataURL = null;\nlet inputSVGSize = null;\nlet inputSVGImage = null;\nconst options = {\n  width: 800,\n  height: 600,\n  spacing: 20,\n  radius: 10,\n  offsetX: 0,\n  offsetY: 0,\n};\nlet rendered = null;\n\nfunction setInputImage(file) {\n  const fr = new FileReader();\n  fr.onload = (event) => {\n    const url = fr.result;\n    const img = new Image();\n    img.src = url;\n    img.onload = () => {\n      inputSVGSize = {\n        width: img.width,\n        height: img.height,\n      };\n      inputSVGDataURL = url;\n      inputSVGImage = img;\n      m.redraw();\n    };\n    img.onerror = () => {\n      alert('Invalid image.');\n    };\n  };\n  fr.readAsDataURL(file);\n}\n\nfunction render(image, width, height, spacing, radius, offsetX, offsetY) {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n  ctx.drawImage(image, 0, 0, width, height);\n  const data = ctx.getImageData(0, 0, width, height);\n  const circles = [];\n  for (let y = 0; y < height; y += spacing) {\n    for (let x = 0; x < width; x += spacing) {\n      const ox = (x + offsetX);\n      const oy = (y + offsetY);\n      if (ox < 0 || ox >= width || oy < 0 || oy >= height) {\n        continue;\n      }\n      const offset = data.width * oy * 4 + ox * 4;\n      const [r, g, b, a] = data.data.slice(offset, offset + 4);\n      if (a > 192) {\n        circles.push({ x: x + radius, y: y + radius, r, g, b, radius });\n      }\n    }\n  }\n  return { circles, width, height };\n}\n\nfunction renderedToSVG(rendered) {\n  const circles = rendered.circles.map((c) =>\n    m('circle', { cx: c.x, cy: c.y, r: c.radius, fill: `rgb(${c.r}, ${c.g}, ${c.b})` })\n  );\n  return m(\n    'svg',\n    {\n      width: rendered.width,\n      height: rendered.height,\n      xmlns: \"http://www.w3.org/2000/svg\",\n    },\n    circles\n  );\n}\n\nfunction exportSVG(rendered) {\n  const tree = renderedToSVG(rendered);\n  const frag = document.createDocumentFragment();\n  m.render(frag, tree);\n  const xml = frag.firstChild.outerHTML;\n  const header = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>`;\n  const file = new File([header, xml], `dots-export-${+new Date()}.svg`, {\n    type: 'image/svg+xml',\n  });\n  const url = URL.createObjectURL(file);\n  const downloadLink = Object.assign(document.createElement('a'), {\n    href: url,\n    download: file.name,\n  });\n  document.body.appendChild(downloadLink);\n  downloadLink.click();\n  setTimeout(() => {\n    downloadLink.parentNode.removeChild(downloadLink);\n    URL.revokeObjectURL(url);\n  }, 1000);\n}\n\nconst optionNumberInput = (field, attrs) => {\n  const finalAttrs = Object.assign({\n    type: 'number',\n    value: options[field],\n    oninput: (e) => {\n      options[field] = e.target.valueAsNumber;\n    },\n  }, attrs);\n  return m('input', finalAttrs);\n};\n\nconst view = () => {\n  return [\n    m('div#controls', [\n      m('label', [\n        m('input[type=file]', {\n          accept: 'image/*',\n          onchange: (event) => setInputImage(event.target.files[0]),\n        }),\n      ]),\n      m('label', 'Output Size', [\n        optionNumberInput('width', { min: 0, step: 1 }),\n        'x',\n        optionNumberInput('height', { min: 0, step: 1 }),\n        m('button', {\n          onclick: () => {\n            options.width = inputSVGSize.width;\n            options.height = inputSVGSize.height;\n          },\n          disabled: !inputSVGSize,\n        }, 'From Original'),\n      ]),\n      m('label', 'Circle Spacing', [\n        optionNumberInput('spacing', { min: 1, step: 1 }),\n      ]),\n      m('label', 'Circle Radius', [\n        optionNumberInput('radius', { min: 1, step: 1 }),\n      ]),\n      m('label', 'Offset', [\n        optionNumberInput('offsetX', { step: 1 }),\n        'x',\n        optionNumberInput('offsetY', { step: 1 }),\n      ]),\n      m(\n        'button',\n        {\n          onclick: () => {\n            rendered = render(\n              inputSVGImage,\n              options.width,\n              options.height,\n              options.spacing,\n              options.radius,\n              options.offsetX,\n              options.offsetY,\n            );\n          },\n          disabled: !inputSVGImage,\n        }, 'Render',\n      ),\n      m(\n        'button',\n        {\n          onclick: () => {\n            exportSVG(rendered);\n          },\n          disabled: !rendered,\n        },\n        'Export',\n      )\n    ]),\n    m('div#inout', [\n      inputSVGDataURL ? m('div#input', m('img', { src: inputSVGDataURL })) : null,\n      rendered ? m('div#output', rendered ? renderedToSVG(rendered) : null) : null,\n    ]),\n  ];\n};\n\n\nm.mount(document.body, { view });\n\n\n\n// WEBPACK FOOTER //\n// ./index.js"],"sourceRoot":""}